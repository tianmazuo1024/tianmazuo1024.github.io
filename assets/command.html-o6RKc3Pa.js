import{_ as s}from"./plugin-vue_export-helper-DlAUqK2U.js";import{c as i,o as n,d as a}from"./app-B5m7CcSj.js";const e={},l=a(`<p>很多<code>Java</code>工程师除了会Java以外，好像不会别的，比如问到常用的<a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">MongoDB</a>命令有哪些，都该怎么使用的时候，很多人都是一问三不知。</p><p>这一点让人很意外，但不是夸大，而是在面试很多Java工程师时的真实结果。</p><p>虽然在系统运行时，必须通过代码来读写数据库的数据，但在日常调试的时候，能够用命令直接和数据库打交道的话，显然比代码要高效很多。</p><p>下面是在调试<a href="https://www.mongodb.com/" target="_blank" rel="noopener noreferrer">MongoDB</a>时，高频会用到的一些命令。</p><div class="language-shell line-numbers-mode" data-highlighter="shiki" data-ext="shell" data-title="shell" style="--shiki-light:#383A42;--shiki-dark:#abb2bf;--shiki-light-bg:#FAFAFA;--shiki-dark-bg:#282c34;"><pre class="shiki shiki-themes one-light one-dark-pro vp-code"><code><span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 创建用户</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; use chebian</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">db.createUser(</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  {</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    user:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;chebian&quot;,</span></span>
<span class="line"><span style="--shiki-light:#0184BC;--shiki-dark:#56B6C2;">    pwd</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;Chebian@help&quot;,</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">    roles:</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;"> [ </span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> role:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;dbOwner&quot;,</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> db:</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> &quot;chebian&quot;</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> }</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> ]</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">  }</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 查看用户</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; use admin</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">db.system.users.find</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">()</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 删除用户</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; db.system.users.remove({user:&quot;suiyi&quot;})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 登录分片副本集：</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; /usr/local/mongodb/bin/mongo 192.168.2.251:60000/chebian</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#A0A1A7;--shiki-dark:#7F848E;--shiki-light-font-style:italic;--shiki-dark-font-style:italic;"># 为集合添加2dsphere索引</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; db.user.ensureIndex({&quot;gispoint&quot;:&quot;2d&quot;})</span></span>
<span class="line"><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&gt; </span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">db.user.ensureIndex(</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">{</span><span style="--shiki-light:#383A42;--shiki-dark:#ABB2BF;">&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">gispoint</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;:&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2dsphere</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;"># 添加LBS信息</span></span>
<span class="line"><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&gt; db.user.update({guid:&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;},{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$set</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">:{guid:&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">1</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">&quot;,gispoint:[116.3801292048, 40.0376598124],updatetime:&quot;</span><span style="--shiki-light:#4078F2;--shiki-dark:#61AFEF;">2016-04-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:05:51&quot;}}, true, false)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.user.update({guid:&quot;2&quot;},{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:{guid:&quot;2&quot;,gispoint:[116.3359254349, 40.0775697409],updatetime:&quot;2016-04-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:05:51&quot;}}, true, false)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.user.update({guid:&quot;3&quot;},{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$set</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:{guid:&quot;3&quot;,gispoint:[116.4393012291, 40.0293400566],updatetime:&quot;2016-04-14</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"> 18:05:51&quot;}}, true, false)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># 查找用户位置</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.user.find({&quot;gispoint&quot;:{</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$near</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:[116.3359254349, 40.0775697409], </span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$maxDistance</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">:0.5/111.12}},{_id:0}).limit(3)</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.runCommand({geoNear:&quot;user&quot;, near:[116.3359254349, 40.0775697409], distanceMultiplier:6378137, maxDistance:1000/6378137, num:10, spherical:true})</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># 聚合操作需要使用2dsphere索引</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.user.aggregate({</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    &quot;</span><span style="--shiki-light:#E45649;--shiki-dark:#E06C75;">$geoNear</span><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&quot;:{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;near&quot;:{</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;type&quot;:&quot;gispoint&quot;, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">            &quot;coordinates&quot;:[116.3359254349, 40.0775697409]</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        }, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;distanceField&quot;:&quot;dist.calculated&quot;, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;distanceMultiplier&quot;:6378137, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;num&quot;:10, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;maxDistance&quot;:10000, </span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">        &quot;spherical&quot;:true</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">    }</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">});</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">其中：</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">near               : GeoJSON或者坐标数组</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">spherical          : 需要使用2dsphere索引，决定了MongoDB如何计算距离，缺省值为false</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">distanceMultiplier : 地球半径，用distanceMultiplier指定地球半径来得到实际的公里或者米的距离，取决于设置的值为6378137还是111.12</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     如果设置的值为6378137，则对应的distance / minDistance单位为米</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">                     如果设置的值为111.12，则对应的distance / minDistance单位为公里</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">minDistance        : 距离中心点的最小范围</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">maxDistance        : 距离中心点的最大范围，2500表示2500米范围内的位置坐标</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">distanceField      : 该字段用来决定是否包含距离字段，必须指定</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">limit              : 返回所有符合条件的位置数量，缺省数量是100条</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">num                : 与limit作用相同，都是返回所有符合条件的位置数量，如果同时指定了limit和num，那么num将覆盖limit</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">uniqueDocs         : 如果为true，那么查询将立即返回匹配的结果并结束查找</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">query              : 查询条件，用来限制查询所匹配的结果，如query:{Name:”肯德基”}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># 去除重复的索引</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.user.getIndexes()</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.user.dropIndex(&quot;gispoint_2d&quot;)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># 查看mongodb最大连接数</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; db.serverStatus().connections</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># 修改mongodb最大连接数，在启动里边加参数</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; --maxConns=20000</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;"># 或者在/etc/mongod.conf中加</span></span>
<span class="line"><span style="--shiki-light:#50A14F;--shiki-dark:#98C379;">&gt; maxConns=20000</span></span></code></pre><div class="line-numbers" aria-hidden="true" style="counter-reset:line-number 0;"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div>`,5),t=[l];function p(h,d){return n(),i("div",null,t)}const c=s(e,[["render",p],["__file","command.html.vue"]]),o=JSON.parse('{"path":"/technology/middleware/mongodb/command.html","title":"常用命令","lang":"zh-CN","frontmatter":{"title":"常用命令","icon":"lemon","category":["中间件","MongoDB"],"tag":["中间件","MongoDB","MongoDB命令"],"date":"2023-01-13T00:00:00.000Z","isOriginal":true,"star":true,"description":"很多Java工程师除了会Java以外，好像不会别的，比如问到常用的MongoDB命令有哪些，都该怎么使用的时候，很多人都是一问三不知。 这一点让人很意外，但不是夸大，而是在面试很多Java工程师时的真实结果。 虽然在系统运行时，必须通过代码来读写数据库的数据，但在日常调试的时候，能够用命令直接和数据库打交道的话，显然比代码要高效很多。 下面是在调试Mo...","head":[["meta",{"property":"og:url","content":"https://vuepress-theme-hope-docs-demo.netlify.app/technology/middleware/mongodb/command.html"}],["meta",{"property":"og:site_name","content":"添码座"}],["meta",{"property":"og:title","content":"常用命令"}],["meta",{"property":"og:description","content":"很多Java工程师除了会Java以外，好像不会别的，比如问到常用的MongoDB命令有哪些，都该怎么使用的时候，很多人都是一问三不知。 这一点让人很意外，但不是夸大，而是在面试很多Java工程师时的真实结果。 虽然在系统运行时，必须通过代码来读写数据库的数据，但在日常调试的时候，能够用命令直接和数据库打交道的话，显然比代码要高效很多。 下面是在调试Mo..."}],["meta",{"property":"og:type","content":"article"}],["meta",{"property":"og:locale","content":"zh-CN"}],["meta",{"property":"article:author","content":"添码座"}],["meta",{"property":"article:tag","content":"中间件"}],["meta",{"property":"article:tag","content":"MongoDB"}],["meta",{"property":"article:tag","content":"MongoDB命令"}],["meta",{"property":"article:published_time","content":"2023-01-13T00:00:00.000Z"}],["script",{"type":"application/ld+json"},"{\\"@context\\":\\"https://schema.org\\",\\"@type\\":\\"Article\\",\\"headline\\":\\"常用命令\\",\\"image\\":[\\"\\"],\\"datePublished\\":\\"2023-01-13T00:00:00.000Z\\",\\"dateModified\\":null,\\"author\\":[{\\"@type\\":\\"Person\\",\\"name\\":\\"添码座\\",\\"url\\":\\"https://www.tianmazuo.com/about/\\"}]}"]]},"headers":[],"git":{},"readingTime":{"minutes":2.27,"words":681},"filePathRelative":"technology/middleware/mongodb/command.md","localizedDate":"2023年1月13日","excerpt":"<p>很多<code>Java</code>工程师除了会Java以外，好像不会别的，比如问到常用的<a href=\\"https://www.mongodb.com/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">MongoDB</a>命令有哪些，都该怎么使用的时候，很多人都是一问三不知。</p>\\n<p>这一点让人很意外，但不是夸大，而是在面试很多Java工程师时的真实结果。</p>\\n<p>虽然在系统运行时，必须通过代码来读写数据库的数据，但在日常调试的时候，能够用命令直接和数据库打交道的话，显然比代码要高效很多。</p>\\n<p>下面是在调试<a href=\\"https://www.mongodb.com/\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">MongoDB</a>时，高频会用到的一些命令。</p>","autoDesc":true}');export{c as comp,o as data};
